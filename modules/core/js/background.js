/** * Created by Charles on 15/02/14. */// permet le stockage des données// ogameData =//     planets : {//         <planetCode> : {//             infos:{},//             resources: {//                 metal:{quantite:0,production:0,max:0},//                 cristal:{quantite:0,production:0,max:0},//                 deuterium:{quantite:0,production:0,max:0}//             },//             buildings : {},//             fleet : {},//             defense : {}//             }//         },//     search: {},//     flyingResources :{}// }var ogameData = {};// la minuterie !var timer;//actualise la productionfunction actualizeProduction(){    $.each(ogameData.planets, function(key, value){        $.each(value.resources, function(key, value){            value.quantite += value.production;        });    });    (function() {timer=setTimeout(actualizeProduction, 1000);})();}//mise à jour des donnéesfunction majdatas(type, planetCode, data){    if(planetCode == null){        ogameData[type] = data;    } else {        if(ogameData.planets == undefined){            ogameData.planets = {};        }        if(ogameData.planets[planetCode] == undefined){            ogameData.planets[planetCode] = {};        }        ogameData.planets[planetCode][type]= data;    }}//got a message from content scriptchrome.extension.onRequest.addListener(    function(request, sender, sendResponse) {        if(request.module != "core"){            return false;        }        majdatas(request.method, request.planetCode, request.data);        (function() {clearTimeout(timer);timer=setTimeout(actualizeProduction, 1000);})();    });